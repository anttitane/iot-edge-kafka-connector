{
  "modulesContent": {
    "$edgeAgent": {
      "properties.desired": {
        "schemaVersion": "1.1",
        "runtime": {
          "type": "docker",
          "settings": {
            "minDockerVersion": "v1.25",
            "registryCredentials": {
              "containerRegistry": {
                "username": "YOUR_REGISTRY_USERNAME",
                "password": "YOUR_REGISTRY_PASSWORD",
                "address": "ghcr.io"
              }
            }
          }
        },
        "systemModules": {
          "edgeAgent": {
            "type": "docker",
            "settings": {
              "image": "mcr.microsoft.com/azureiotedge-agent:1.5",
              "createOptions": "{}"
            }
          },
          "edgeHub": {
            "type": "docker",
            "status": "running",
            "restartPolicy": "always",
            "startupOrder": 0,
            "settings": {
              "image": "mcr.microsoft.com/azureiotedge-hub:1.5",
              "createOptions": "{\"HostConfig\":{\"PortBindings\":{\"443/tcp\":[{\"HostPort\":\"443\"}],\"5671/tcp\":[{\"HostPort\":\"5671\"}],\"8883/tcp\":[{\"HostPort\":\"8883\"}]}}}"
            }
          }
        },
        "modules": {
          "KafkaConnector": {
            "version": "1.0",
            "type": "docker",
            "status": "running",
            "restartPolicy": "always",
            "settings": {
              "image": "ghcr.io/your-org/iotedge-kafka-connector:1.0",
              "createOptions": "{ \"HostConfig\": { \"NetworkMode\": \"host\" } }"
            },
            "env": {
              "Logging__LogLevel__Default": { "value": "Debug" },
              "Kafka__BootstrapServers": { "value": "localhost:9092" },
              "Kafka__Topic": { "value": "telemetry.raw" },
              "Kafka__GroupId": { "value": "iot-edge-connector-dev" },
              "Kafka__EnableAutoCommit": { "value": "true" },
              "Kafka__SessionTimeoutMs": { "value": "10000" },
              "Kafka__AutoOffsetReset": { "value": "Earliest" },
              "Kafka__RetryBackoffSeconds": { "value": "5" },
              "IoTHub__ConnectionString": { "value": "YOUR_IOTHUB_DEVICE_CONNECTION_STRING_IS_NOT_NEEDED_FOR_IOT_EDGE_MODULE" },
              "IoTHub__TransportType": { "value": "Mqtt_Tcp_Only" },
              "IoTHub__OutputName": { "value": "output1" },
              "Processing__Mode": { "value": "Aggregation" },
              "Processing__AggregationWindowSeconds": { "value": "15" },
              "Batching__IsEnabled": { "value": "true" },
              "Batching__MaxBatchSize": { "value": "10" },
              "Batching__BatchIntervalSeconds": { "value": "120" },
              "Output__Action": { "value": "LogAndSend" },
              "Output__LogSerializedPayload": { "value": "true" },
              "Parsing__Interests__0__Source": { "value": "mqtt" },
              "Parsing__Interests__0__NodeName": { "value": "sensor1" },
              "Parsing__Interests__0__MeasurementKey": { "value": "temperature" },
              "Parsing__Interests__1__Source": { "value": "mqtt" },
              "Parsing__Interests__1__NodeName": { "value": "sensor2" },
              "Parsing__Interests__1__MeasurementKey": { "value": "humidity" },
              "Parsing__Interests__2__Source": { "value": "opcua" },
              "Parsing__Interests__2__NodeName": { "value": "sensor1" },
              "Parsing__Interests__2__MeasurementKey": { "value": "" }
            }
          }
        }
      }
    },
    "$edgeHub": {
      "properties.desired": {
        "schemaVersion": "1.1",
        "routes": {
          "CatchAll": "FROM /messages/* INTO $upstream"
        },
        "storeAndForwardConfiguration": { "timeToLiveSecs": 7200 }
      }
    }
  }
}
